<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spring í•™ìŠµ ì²´í¬</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding-top: 70px;
        }
        .navbar-custom {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .navbar-brand {
            font-size: 1.5rem;
            font-weight: bold;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .btn-login, .btn-signup {
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: 500;
            transition: all 0.3s;
        }
        .btn-login {
            color: #667eea;
            border: 2px solid #667eea;
        }
        .btn-login:hover {
            background: #667eea;
            color: white;
        }
        .btn-signup {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
        }
        .btn-signup:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        .btn-logout {
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: 500;
            background: #dc3545;
            color: white;
            border: none;
        }
        .btn-logout:hover {
            background: #c82333;
        }
        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .user-badge {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 5px 15px;
            border-radius: 15px;
            font-size: 0.9rem;
        }
        .main-container {
            max-width: 1000px;
            width: 100%;
            padding: 20px;
            margin: 0 auto;
        }
        .hero-section {
            text-align: center;
            color: white;
            margin-bottom: 50px;
        }
        .hero-title {
            font-size: 4rem;
            font-weight: bold;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        .hero-subtitle {
            font-size: 1.5rem;
            opacity: 0.9;
        }
        .card-mode {
            border: none;
            border-radius: 20px;
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
            height: 100%;
            min-height: 300px;
            background: white;
        }
        .card-mode:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }
        .mode-icon {
            font-size: 80px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
<!-- Navigation Bar -->
<nav class="navbar navbar-expand-lg navbar-light navbar-custom">
    <div class="container">
        <a class="navbar-brand" href="/">â˜• Spring Quiz</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ms-auto align-items-center" id="navbarMenu">
                <!-- ë™ì ìœ¼ë¡œ ìƒì„± -->
            </ul>
        </div>
    </div>
</nav>

<div class="main-container">
    <!-- Hero Section -->
    <div class="hero-section">
        <div class="hero-title">â˜• Spring Quiz</div>
        <div class="hero-subtitle">ë‹¹ì‹ ì˜ Spring ì§€ì‹ì„ í…ŒìŠ¤íŠ¸í•´ë³´ì„¸ìš”</div>
    </div>

    <!-- Mode Selection -->
    <div class="row g-4 mb-5">
        <div class="col-md-6">
            <div class="card card-mode" onclick="location.href='/category'">
                <div class="card-body text-center d-flex flex-column justify-content-center">
                    <div class="mode-icon">ğŸ“š</div>
                    <h3 class="card-title fw-bold mb-3">ììœ  í•™ìŠµ ëª¨ë“œ</h3>
                    <p class="card-text text-muted mb-4">
                        ì¹´í…Œê³ ë¦¬ì™€ ë‚œì´ë„ë¥¼ ì„ íƒí•´ì„œ<br>
                        ììœ ë¡­ê²Œ í•™ìŠµí•˜ì„¸ìš”
                    </p>
                    <div>
                        <span class="badge bg-primary me-2">ì§„í–‰ë„ ì¶”ì </span>
                        <span class="badge bg-success">ë¬´ì œí•œ</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="card card-mode" onclick="showChallengeModal()">
                <div class="card-body text-center d-flex flex-column justify-content-center">
                    <div class="mode-icon">ğŸ†</div>
                    <h3 class="card-title fw-bold mb-3">ì±Œë¦°ì§€ ëª¨ë“œ</h3>
                    <p class="card-text text-muted mb-4">
                        10ê°œ ë¬¸ì œë¥¼ ì—°ì†ìœ¼ë¡œ í’€ê³ <br>
                        ì‹¤ë ¥ì„ í…ŒìŠ¤íŠ¸í•˜ì„¸ìš”
                    </p>
                    <div>
                        <span class="badge bg-warning text-dark me-2">ì‹œê°„ ì œí•œ</span>
                        <span class="badge bg-danger">ëœë¤</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Info Section (ë¡œê·¸ì¸ ì•ˆ í–ˆì„ ë•Œë§Œ í‘œì‹œ) -->
    <div class="text-center" id="guestInfo">
        <p class="text-white mb-3">ğŸ’¡ ë¡œê·¸ì¸ ì—†ì´ ë°”ë¡œ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!</p>
        <p class="text-white-50 small">íšŒì›ê°€ì… ì‹œ ì§„í–‰ë„ ì €ì¥ ë° í†µê³„ í™•ì¸ ê°€ëŠ¥</p>
    </div>
</div>

<!-- Challenge Modal -->
<div class="modal fade" id="challengeModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">ğŸ† ì±Œë¦°ì§€ ì„¤ì •</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="mb-3">
                    <label class="form-label fw-bold">ì¹´í…Œê³ ë¦¬</label>
                    <select class="form-select" id="challengeCategory">
                        <option value="SPRING_CORE">Spring Core</option>
                        <option value="SPRING_BOOT">Spring Boot</option>
                        <option value="SPRING_MVC">Spring MVC</option>
                        <option value="SPRING_DATA_JPA">Spring Data JPA</option>
                        <option value="SPRING_SECURITY">Spring Security</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label class="form-label fw-bold">ë‚œì´ë„</label>
                    <select class="form-select" id="challengeDifficulty">
                        <option value="BEGINNER">ì´ˆê¸‰</option>
                        <option value="INTERMEDIATE">ì¤‘ê¸‰</option>
                        <option value="ADVANCED">ê³ ê¸‰</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ì·¨ì†Œ</button>
                <button type="button" class="btn btn-primary" onclick="startChallenge()">ì‹œì‘í•˜ê¸°</button>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    let challengeModal;

    document.addEventListener('DOMContentLoaded', function() {
        updateNavbar();
        challengeModal = new bootstrap.Modal(document.getElementById('challengeModal'));
    });

    function updateNavbar() {
        const navbarMenu = document.getElementById('navbarMenu');
        const guestInfo = document.getElementById('guestInfo');

        // ë¡œê·¸ì¸ ìƒíƒœ ì²´í¬
        const accessToken = localStorage.getItem('access_token');
        const user = JSON.parse(localStorage.getItem('user') || '{}');
        const isLoggedIn = !!accessToken;
        const isAdmin = user.role === 'ROLE_ADMIN';

        if (isLoggedIn) {
            // ë¡œê·¸ì¸ ìƒíƒœ
            guestInfo.style.display = 'none';

            navbarMenu.innerHTML = `
            <li class="nav-item">
                <a class="nav-link" href="/statistics">ğŸ“Š í†µê³„</a>
            </li>
            ${isAdmin ? `
                <li class="nav-item">
                    <a class="nav-link" href="/admin">ğŸ› ï¸ ê´€ë¦¬ì</a>
                </li>
            ` : ''}
            <li class="nav-item ms-3">
                <span class="user-badge">ğŸ‘¤ ${user.loginId || 'ì‚¬ìš©ì'}</span>
            </li>
            <li class="nav-item ms-2">
                <button class="btn btn-logout" onclick="logout()">ë¡œê·¸ì•„ì›ƒ</button>
            </li>
        `;
        } else {
            // ë¹„ë¡œê·¸ì¸ ìƒíƒœ
            guestInfo.style.display = 'block';

            navbarMenu.innerHTML = `
            <li class="nav-item me-2">
                <a href="/login" class="btn btn-login">ë¡œê·¸ì¸</a>
            </li>
            <li class="nav-item">
                <a href="/signup" class="btn btn-signup">íšŒì›ê°€ì…</a>
            </li>
        `;
        }
    }

    function logout() {
        if (confirm('ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
            // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ì‚­ì œ
            localStorage.removeItem('access_token');
            localStorage.removeItem('user');

            // TODO: ì„œë²„ì— ë¡œê·¸ì•„ì›ƒ ìš”ì²­ (ì˜µì…˜)
            // fetch('/api/users/logout', { method: 'POST' });

            // í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨
            location.reload();
        }
    }

    function showChallengeModal() {
        challengeModal.show();
    }

    function startChallenge() {
        const category = document.getElementById('challengeCategory').value;
        const difficulty = document.getElementById('challengeDifficulty').value;
        location.href = `/problems?mode=challenge&category=${category}&difficulty=${difficulty}`;
    }
</script>
</body>
</html>